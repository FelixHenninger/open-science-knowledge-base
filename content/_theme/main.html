{% extends "base.html" %}

{% block site_name %}
  {% if config.site_name == page.title %}
    Open Science <strong>Knowledge Base</strong>
  {% else %}
    <span class="md-header-nav__topic">
      Open Science <strong>Knowledge Base</strong>
    </span>
    <span class="md-header-nav__topic">
      {{ page.title }}
    </span>
  {% endif %}
{% endblock %}

{% block hero %}
  {% if page.is_homepage %}
    {% include "partials/hero_homepage.html" with context %}
  {% elif page and page.meta and page.meta.hero %}
    {% include "partials/hero.html" with context %}
  {% endif %}
{% endblock %}

{% block content %}
  {% if page.edit_url %}
    <a href="{{ page.edit_url }}" title="{{ lang.t('edit.link.title') }}" class="md-icon md-content__icon">&#xE3C9;</a>
  {% endif %}
  {% if not "\x3ch1" in page.content %}
    <h1>{{ page.title | default(config.site_name, true)}}</h1>
  {% endif %}
  {% if page.is_homepage %}
    <div class="md-homepage">
  {% endif %}
  {{ page.content }}
  {% if page.is_homepage %}
    </div>
  {% endif %}
  {% block source %}
    {% if page and page.meta and page.meta.source %}
      <h2 id="__source">{{ lang.t("meta.source") }}</h2>
      {% set repo = config.repo_url %}
      {% if repo | last == "/" %}
        {% set repo = repo[:-1] %}
      {% endif %}
      {% set path = page.meta.path | default([""]) %}
      {% set file = page.meta.source %}
      <a href="{{ [repo, path, file] | join('/') }}" title="{{ file }}" class="md-source-file">
        {{ file }}
      </a>
    {% endif %}
  {% endblock %}
{% endblock %}
